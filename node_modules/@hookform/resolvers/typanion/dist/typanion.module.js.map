{"version":3,"file":"typanion.module.js","sources":["../src/typanion.ts"],"sourcesContent":["import type { FieldErrors } from 'react-hook-form';\nimport { toNestError, validateFieldsNatively } from '@hookform/resolvers';\nimport type { Resolver } from './types';\n\nconst parseErrors = (\n  errors: string[],\n  parsedErrors: FieldErrors = {},\n  _path = '',\n) => {\n  return errors.reduce((acc, error) => {\n    const [_key, _message] = error.split(':')\n    const key = _key.slice(1)\n    const message = _message.trim()\n\n    acc[key] = {\n      message,\n    };\n\n    return acc;\n  }, parsedErrors);\n};\n\nexport const typanionResolver: Resolver =\n  (validator, validatorOptions = {}) =>\n    (values, _, options) => {\n      const rawErrors: string[] = []\n      const isValid = validator(values, {errors: rawErrors, ...validatorOptions})\n      const parsedErrors = parseErrors(rawErrors)\n\n      if (!isValid) {\n        return { values: {}, errors: toNestError(parsedErrors, options) };\n      }\n\n      options.shouldUseNativeValidation && validateFieldsNatively(parsedErrors, options);\n\n      return { values, errors: {} };\n    };"],"names":["typanionResolver","validator","validatorOptions","values","_","options","rawErrors","isValid","errors","parsedErrors","_path","reduce","acc","error","split","_message","key","slice","message","trim","parseErrors","shouldUseNativeValidation","validateFieldsNatively","toNestError"],"mappings":"6RAIA,IAkBaA,EACX,SAACC,EAAWC,mBAAAA,IAAAA,EAAmB,aAC5BC,EAAQC,EAAGC,GACV,IAAMC,EAAsB,GACtBC,EAAUN,EAAUE,KAASK,OAAQF,GAAcJ,IACnDO,EAvBQ,SAClBD,EACAC,EACAC,GAEA,gBAHAD,IAAAA,EAA4B,IAGrBD,EAAOG,OAAO,SAACC,EAAKC,SACAA,EAAMC,MAAM,KAAxBC,OACPC,OAAWC,MAAM,GACjBC,EAAUH,EAASI,OAMzB,OAJAP,EAAII,GAAO,CACTE,QAAAA,GAGKN,GACNH,GAQsBW,CAAYd,GAEjC,OAAKC,GAILF,EAAQgB,2BAA6BC,EAAuBb,EAAcJ,GAEnE,CAAEF,OAAAA,EAAQK,OAAQ,KALhB,CAAEL,OAAQ,GAAIK,OAAQe,EAAYd,EAAcJ"}